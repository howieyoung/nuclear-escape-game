(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8468:function(e,s,t){Promise.resolve().then(t.bind(t,153))},153:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return N}});var n=t(3827),l=t(4232),i=t(4090),a=t(2175),r=t(389),c=t(985);let d={URBAN:"urban",RURAL:"rural",MOUNTAIN:"mountain"},o={[d.URBAN]:.15,[d.RURAL]:.2,[d.MOUNTAIN]:.25},m={duration:30,speed:50,diffusionD:2},x={SPRING:"spring",SUMMER:"summer",AUTUMN:"autumn",WINTER:"winter"},h={[x.SPRING]:{direction:135,speed:15,speedRange:{min:10,max:20},description:"春季（3-5月）：東南風，平均風速 15 km/h，範圍 10-20 km/h"},[x.SUMMER]:{direction:225,speed:17.5,speedRange:{min:10,max:25},description:"夏季（6-8月）：西南風，平均風速 17.5 km/h，範圍 10-25 km/h"},[x.AUTUMN]:{direction:225,speed:20,speedRange:{min:15,max:25},description:"秋季（9-11月）：西南風，平均風速 20 km/h，範圍 15-25 km/h"},[x.WINTER]:{direction:45,speed:30,speedRange:{min:20,max:40},description:"冬季（12-2月）：東北風，平均風速 30 km/h，範圍 20-40 km/h"}};function u(){let{plantLocation:e,setPlantLocation:s,windDirection:t,setWindDirection:l,windSpeed:u,setWindSpeed:p,simulationTime:g,setSimulationTime:j,isSimulationRunning:f,startSimulation:N,pauseSimulation:b,spreadSpeed:w,setSpreadSpeed:y,timeRemaining:v,updateTimeRemaining:R,userLocation:S,setUserLocation:M,resetGame:A}=(0,r.g)(),[U,T]=(0,i.useState)(!1),[k,I]=(0,i.useState)("all"),[L,C]=(0,i.useState)("N/A"),[E,D]=(0,i.useState)(o[d.RURAL]),[P,_]=(0,i.useState)(x.SUMMER),[F,O]=(0,i.useState)(null),[W,q]=(0,i.useState)(!1),[G,B]=(0,i.useState)(0),Y=e=>null===e?"N/A":e<=0?"已到達":"".concat(Math.floor(e/86400).toString().padStart(2,"0"),":").concat(Math.floor(e%86400/3600).toString().padStart(2,"0"),":").concat(Math.floor(e%3600/60).toString().padStart(2,"0"),":").concat((e%60).toString().padStart(2,"0")),K=()=>{if(!S||!e)return console.log("Missing location data:",{userLocation:S,plantLocation:e}),null;let s=z(S[0],S[1],e[0],e[1]),n=1e3*s,l=1e3*u/3600,i=Math.atan2(S[1]-e[1],S[0]-e[0]),a=(.4*Math.cos(i+t*Math.PI/180)+1)/2;console.log("Initial parameters:",{distanceKm:s,distanceMeters:n,windSpeedMS:l,windFactor:a,userAngle:180*i/Math.PI,windDirection:t});let r=e=>{if(e<=m.duration)return m.speed*e*.5;{let s=m.speed*m.duration*.5,t=Math.sqrt(e/m.duration);return Math.max(1e3,s+Math.sqrt(2*m.diffusionD*(e-m.duration))*t)}},c=0,d=259200,o=null;console.log("Search range:",{left:0,right:259200});for(let e=0;e<100;e++){let s=(c+d)/2,t=r(s),i=l*s,m=i*a,x=t+m;if(console.log("Time calculation iteration:",{iteration:e,time:s,baseDistance:t,windInfluence:i,windDiffusion:m,totalDistance:x,targetDistance:n,difference:Math.abs(x-n),windFactor:a}),1e3>Math.abs(x-n)){o=s;break}x<n?c=s:d=s}return console.log("Final time calculation:",{distanceKm:s,distanceMeters:n,windSpeedMS:l,windFactor:a,userAngle:180*i/Math.PI,windDirection:t,result:o}),o},V=()=>{let e=K();if(console.log("Initial time from calculateTimeRemaining:",e),null===e)return console.log("No initial time calculated"),null;let s=60*g;if(console.log("Simulation time in seconds:",s),s>=e)return console.log("Radiation has already reached the user"),0;let t=Math.max(0,e-s);return console.log("Calculated remaining time:",t),t},X=(0,i.useCallback)(()=>{console.log("Updating time display with current parameters:",{windSpeed:u,windDirection:t,userLocation:S,plantLocation:e,simulationTime:g});let s=V();console.log("Time remaining:",s),C(Y(s))},[S,e,u,t,g,f]);(0,i.useEffect)(()=>{console.log("Parameters changed:",{userLocation:S,plantLocation:e,windSpeed:u,windDirection:t,simulationTime:g,isSimulationRunning:f}),S&&e&&X()},[S,e,u,t,g,f,X]),(0,i.useEffect)(()=>{let s;let t=()=>{f&&S&&e&&X(),s=requestAnimationFrame(t)};return f&&(s=requestAnimationFrame(t)),()=>{s&&cancelAnimationFrame(s)}},[f,S,e,X]);let z=(e,s,t,n)=>{let l=(t-e)*Math.PI/180,i=(n-s)*Math.PI/180,a=Math.sin(l/2)*Math.sin(l/2)+Math.cos(e*Math.PI/180)*Math.cos(t*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371};(0,i.useEffect)(()=>{let e;return f&&v>0&&(e=setInterval(()=>{R(Math.max(0,v-1))},c.ib.UPDATE_INTERVAL)),()=>{e&&clearInterval(e)}},[f,v,R]);let H=e=>{f||W?(I(e),T(!0)):J(e)},J=e=>{switch(e){case"plant":s(null);break;case"user":M(null);break;case"all":q(!1),B(0),j(0);let t=ea();_(t);let n=h[t];l(n.direction),p(n.speed),y(1),s(null),M(null),A(),O(null),X()}},Q=async(e,s)=>{for(let t of(await fetch("/data/taiwan_counties.geojson").then(e=>e.json())).features){let n=t.properties;if(ee([s,e],t.geometry.coordinates[0])){if(console.log("位置在".concat(n.name,"範圍內")),"extreme"===n.evacuation_difficulty&&Z(e,s))return console.log("判定為山區（基於地形資料）"),d.MOUNTAIN;if("high"===n.density&&("high"===n.evacuation_difficulty||"extreme"===n.evacuation_difficulty)&&$(e,s))return console.log("判定為都市地區（基於人口密度和地形）"),d.URBAN;return console.log("判定為一般地區"),d.RURAL}}return Z(e,s)?(console.log("不在縣市範圍內，但位於山區"),d.MOUNTAIN):(console.log("不在任何縣市範圍內，預設為一般地區"),d.RURAL)},Z=(e,s)=>[{name:"中央山脈",bounds:{north:24.5,south:22,east:121.5,west:120.5}},{name:"雪山山脈",bounds:{north:25,south:24,east:121.5,west:120.8}},{name:"阿里山山脈",bounds:{north:23.8,south:23,east:121,west:120.5}}].some(t=>{let n=e<=t.bounds.north&&e>=t.bounds.south&&s<=t.bounds.east&&s>=t.bounds.west;return n&&console.log("位於".concat(t.name,"範圍內")),n}),$=(e,s)=>[{name:"台北市",bounds:{north:25.2,south:25,east:121.6,west:121.4}},{name:"新北市",bounds:{north:25.2,south:24.9,east:121.5,west:121.2}},{name:"台中市",bounds:{north:24.3,south:24.1,east:120.7,west:120.5}},{name:"高雄市",bounds:{north:22.7,south:22.5,east:120.4,west:120.2}}].some(t=>{let n=e<=t.bounds.north&&e>=t.bounds.south&&s<=t.bounds.east&&s>=t.bounds.west;return n&&console.log("位於".concat(t.name,"都市範圍內")),n}),ee=(e,s)=>{let t=e[0],n=e[1],l=!1;for(let e=0,i=s.length-1;e<s.length;i=e++){let a=s[e][0],r=s[e][1],c=s[i][0],d=s[i][1];r>n!=d>n&&t<(c-a)*(n-r)/(d-r)+a&&(l=!l)}return l},es=async(e,s)=>{try{let t=await Q(e,s),n=o[t];if(D(n),en(t),console.log("更新擴散參數:",{environmentType:t,diffusionCoefficient:n,location:{lat:e,lng:s}}),g>0){let e=60*g,s=el(e),t=1e3*u/3600,l=t*e;console.log("重新計算擴散:",{timeSeconds:e,baseRadius:s,windSpeedMS:t,windInfluence:l,diffusionCoefficient:n})}}catch(e){console.error("更新擴散參數時發生錯誤:",e),D(o[d.RURAL]),en(d.RURAL)}};(0,i.useEffect)(()=>{e&&es(e[0],e[1])},[e]);let[et,en]=(0,i.useState)(d.RURAL);(0,i.useEffect)(()=>{e&&Q(e[0],e[1]).then(e=>{en(e)}).catch(e=>{console.error("環境檢測錯誤:",e),en(d.RURAL)})},[e]);let el=e=>{if(e<=m.duration)return m.speed*e*.5;{let s=m.speed*m.duration*.5,t=Math.sqrt(e/m.duration);return Math.max(1e3,s+Math.sqrt(2*m.diffusionD*(e-m.duration))*t)}};(0,i.useEffect)(()=>{if(e&&g>0){let e=60*g,s=el(e),t=1e3*u/3600,n=t*e;console.log("風況改變，重新計算擴散:",{timeSeconds:e,baseRadius:s,windSpeedMS:t,windInfluence:n,currentDiffusionD:E})}},[u,t,E]),(0,i.useEffect)(()=>{if(e&&g>0){let e=60*g,s=el(e),t=1e3*u/3600,n=t*e;console.log("時間改變，重新計算擴散:",{timeSeconds:e,baseRadius:s,windSpeedMS:t,windInfluence:n,currentDiffusionD:E})}},[g]);let ei=e=>{let s=h[e];l(s.direction),p(s.speed),_(e)};(0,i.useEffect)(()=>{let e;return W&&(e=setInterval(()=>{B(e=>{let s=e+1;return s>48?(q(!1),0):(j(60*s),s)})},1500)),()=>{e&&clearInterval(e)}},[W]);let ea=()=>{let e=new Date().getMonth()+1;return e>=3&&e<=5?x.SPRING:e>=6&&e<=8?x.SUMMER:e>=9&&e<=11?x.AUTUMN:x.WINTER};return(0,i.useEffect)(()=>{let e=ea();_(e),ei(e)},[]),(0,n.jsxs)(a.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-6 bg-white rounded-lg shadow-lg",children:[(0,n.jsx)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg text-xs",children:(0,n.jsxs)("ol",{className:"list-decimal list-inside space-y-2 text-gray-700",children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:"font-medium text-yellow-600",children:"設置模擬核災發生地："}),"在地圖上點擊第一個位置，這將被設定為模擬核災發生地",e&&(0,n.jsx)("button",{onClick:()=>H("plant"),className:"ml-2 px-2 py-1 text-xxs bg-red-100 hover:bg-red-200 text-red-600 rounded transition-colors",children:"重新設定"})]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:"font-medium text-yellow-600",children:"設置用戶位置："}),"在地圖上點擊第二個位置，這將被設定為用戶所在地",S&&(0,n.jsx)("button",{onClick:()=>H("user"),className:"ml-2 px-2 py-1 text-xxs bg-red-100 hover:bg-red-200 text-red-600 rounded transition-colors",children:"重新設定"})]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:"font-medium",children:"調整模擬參數："}),"可以調整季節、風向、風速等參數"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:"font-medium",children:"開始模擬："}),"點擊「開始動態模擬」按鈕開始模擬"]})]})}),(0,n.jsxs)("div",{className:"mt-4 p-4 bg-white rounded-lg shadow",children:[(0,n.jsx)("h3",{className:"text-xs font-semibold mb-4",children:"模擬控制"}),(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsx)("button",{onClick:()=>{W?q(!1):q(!0),B(0)},disabled:!e,className:"px-4 py-2 rounded-lg font-medium transition-colors\n              ".concat(e?W?"bg-red-500 hover:bg-red-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white":"bg-gray-300 cursor-not-allowed text-gray-500"),children:W?"停止動態模擬":"開始動態模擬"}),(0,n.jsx)("button",{onClick:()=>H("all"),className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors",children:"重置模擬"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[W&&(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),(0,n.jsxs)("span",{className:"text-xs text-gray-700",children:["當前模擬時間：",G," 小時"]})]}),!e&&(0,n.jsx)("span",{className:"text-xs text-gray-500",children:"（請先設置模擬核災初始地）"})]}),W&&(0,n.jsx)("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2",children:(0,n.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(G/48*100,"%")}})}),(0,n.jsxs)("p",{className:"mt-2 text-xs text-gray-600",children:["剩餘時間：",L]})]}),(0,n.jsxs)("div",{className:"mt-4 p-4 bg-white rounded-lg shadow",children:[(0,n.jsx)("h3",{className:"text-xs font-semibold mb-4",children:"風向控制"}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"季節選擇"}),(0,n.jsx)("div",{className:"grid grid-cols-4 gap-2",children:Object.entries(x).map(e=>{let[s,t]=e;return(0,n.jsx)("button",{onClick:()=>{_(t),ei(t)},className:"px-3 py-2 rounded-lg text-xs font-medium transition-colors\n                  ".concat(P===t?"bg-blue-500 text-white shadow-md":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:"SPRING"===s?"春季 (3-5月)":"SUMMER"===s?"夏季 (6-8月)":"AUTUMN"===s?"秋季 (9-11月)":"冬季 (12-2月)"},t)})}),(0,n.jsx)("p",{className:"mt-2 text-xs text-gray-600",children:P===ea()?"當前季節（根據系統日期）":h[P].description})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-xs font-medium mb-2",children:"風向角度"}),(0,n.jsx)("input",{type:"range",min:"0",max:"359",value:t,onChange:e=>{let s=parseInt(e.target.value);console.log("Wind angle changed:",s),l(s)},className:"w-full"}),(0,n.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[(0,n.jsx)("span",{children:"北 (0\xb0)"}),(0,n.jsx)("span",{children:"東 (90\xb0)"}),(0,n.jsx)("span",{children:"南 (180\xb0)"}),(0,n.jsx)("span",{children:"西 (270\xb0)"})]}),(0,n.jsxs)("p",{className:"mt-1 text-xs",children:["當前風向：",t,"\xb0"]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs font-medium mb-2",children:"風速 (km/h)"}),(0,n.jsx)("input",{type:"range",min:"0",max:"100",value:u,onChange:e=>{let s=parseInt(e.target.value);console.log("Wind speed changed:",s),p(s),setTimeout(()=>{let e=V();console.log("Recalculated time after wind speed change:",e),C(Y(e))},0)},className:"w-full"}),(0,n.jsxs)("p",{className:"mt-1 text-xs",children:["當前風速：",u," km/h"]})]}),(0,n.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,n.jsx)("h3",{className:"font-medium mb-2 text-sm",children:"當前設置："}),(0,n.jsxs)("div",{className:"space-y-2 text-xs text-gray-700",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:"font-medium",children:"模擬核災發生地："}),e?"已設置 (".concat(e[0].toFixed(4),", ").concat(e[1].toFixed(4),")"):"未設置"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:"font-medium",children:"用戶位置："}),S?"已設置 (".concat(S[0].toFixed(4),", ").concat(S[1].toFixed(4),")"):"未設置"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:"font-medium",children:"當前季節："}),P,P===ea()&&" (根據系統日期)"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:"font-medium",children:"風向："}),(e=>{let s=(e%360+360)%360;for(let e of[{name:"北風",range:[337.5,22.5]},{name:"東北風",range:[22.5,67.5]},{name:"東風",range:[67.5,112.5]},{name:"東南風",range:[112.5,157.5]},{name:"南風",range:[157.5,202.5]},{name:"西南風",range:[202.5,247.5]},{name:"西風",range:[247.5,292.5]},{name:"西北風",range:[292.5,337.5]}]){let[t,n]=e.range;if(t>n){if(s>=t||s<n)return e.name}else if(s>=t&&s<n)return e.name}return"北風"})(t)," (",t,"\xb0)"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:"font-medium",children:"風速："}),u," km/h"]})]})]})]}),(0,n.jsxs)("div",{className:"mt-4 p-4 bg-white rounded shadow",children:[(0,n.jsx)("h3",{className:"text-xs font-bold mb-2",children:"初始事件環境資訊"}),(0,n.jsx)("div",{className:"space-y-4",children:e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,n.jsx)("p",{className:"font-medium mb-2 text-sm",children:"當前環境："}),(0,n.jsxs)("ul",{className:"list-disc list-inside ml-2 text-xs",children:[(0,n.jsx)("li",{className:"text-yellow-600",children:(e=>{switch(e){case d.URBAN:return"都市地區：建築物阻擋，擴散係數較低";case d.MOUNTAIN:return"山區：地形複雜，擴散係數較高";case d.RURAL:return"一般地區：標準擴散係數";default:return"未知環境類型"}})(et)}),(0,n.jsxs)("li",{children:["擴散係數：",E]}),(0,n.jsxs)("li",{children:["位置：緯度 ",e[0].toFixed(4),", 經度 ",e[1].toFixed(4)]})]})]}),(0,n.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,n.jsx)("p",{className:"font-medium mb-2 text-sm",children:"環境類型說明："}),(0,n.jsxs)("ul",{className:"list-disc list-inside ml-2 text-xs",children:[(0,n.jsx)("li",{className:et===d.URBAN?"text-yellow-600":"",children:"都市地區：0.15（建築物阻擋）"}),(0,n.jsx)("li",{className:et===d.RURAL?"text-yellow-600":"",children:"一般地區：0.20（標準值）"}),(0,n.jsx)("li",{className:et===d.MOUNTAIN?"text-yellow-600":"",children:"山區：0.25（地形複雜）"})]})]})]}):(0,n.jsx)("p",{className:"text-gray-500",children:"請先選擇模擬核災發生地以顯示環境資訊"})})]}),(0,n.jsx)("div",{className:"mt-4 p-4 bg-white rounded shadow",children:(0,n.jsxs)("div",{className:"space-y-4 text-xs",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium mb-2",children:"擴散參數說明"}),(0,n.jsxs)("div",{className:"pl-4 space-y-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:"初始事件階段："}),(0,n.jsxs)("ul",{className:"list-disc list-inside ml-2",children:[(0,n.jsx)("li",{children:"持續時間：30 秒"}),(0,n.jsx)("li",{children:"擴散速度：50 m/s"}),(0,n.jsx)("li",{children:"最小擴散半徑：1000 公尺"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:"自然擴散階段："}),(0,n.jsxs)("ul",{className:"list-disc list-inside ml-2",children:[(0,n.jsx)("li",{children:"擴散係數 (D)：2.0 m\xb2/s"}),(0,n.jsx)("li",{children:"時間影響因子：√(t/t₀)"}),(0,n.jsx)("li",{children:"t₀ = 初始事件階段時間 (30秒)"})]})]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium mb-2",children:"擴散方程式說明"}),(0,n.jsxs)("div",{className:"pl-4 space-y-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:"1. 初始事件階段 (t ≤ 30秒)："}),(0,n.jsx)("p",{className:"font-mono",children:"r = max(1000, v \xd7 t)"}),(0,n.jsx)("p",{children:"其中："}),(0,n.jsxs)("ul",{className:"list-disc list-inside ml-2",children:[(0,n.jsx)("li",{children:"v = 50 m/s (初始擴散速度)"}),(0,n.jsx)("li",{children:"t = 時間 (秒)"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:"2. 自然擴散階段 (t > 30秒)："}),(0,n.jsx)("p",{className:"font-mono",children:"r = r₀ + √(2 \xd7 D \xd7 (t - t₀)) \xd7 √(t/t₀)"}),(0,n.jsx)("p",{children:"其中："}),(0,n.jsxs)("ul",{className:"list-disc list-inside ml-2",children:[(0,n.jsx)("li",{children:"r₀ = 初始事件階段結束時的半徑"}),(0,n.jsx)("li",{children:"D = 2.0 m\xb2/s (擴散係數)"}),(0,n.jsx)("li",{children:"t₀ = 30秒 (初始階段時間)"}),(0,n.jsx)("li",{children:"t = 總時間 (秒)"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:"3. 風向影響因子："}),(0,n.jsx)("p",{className:"font-mono",children:"f = (cos(θ + θ_w) + 1) / 2"}),(0,n.jsx)("p",{children:"其中："}),(0,n.jsxs)("ul",{className:"list-disc list-inside ml-2",children:[(0,n.jsx)("li",{children:"θ = 擴散角度"}),(0,n.jsx)("li",{children:"θ_w = 風向角度"}),(0,n.jsx)("li",{children:"f 範圍：0 到 1"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:"4. 風速影響距離："}),(0,n.jsx)("p",{className:"font-mono",children:"d_w = v_w \xd7 t \xd7 f"}),(0,n.jsx)("p",{children:"其中："}),(0,n.jsxs)("ul",{className:"list-disc list-inside ml-2",children:[(0,n.jsx)("li",{children:"v_w = 風速 (m/s)"}),(0,n.jsx)("li",{children:"t = 時間 (秒)"}),(0,n.jsx)("li",{children:"f = 風向影響因子"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:"5. 總擴散距離："}),(0,n.jsx)("p",{className:"font-mono",children:"d_total = r + d_w"}),(0,n.jsx)("p",{children:"其中："}),(0,n.jsxs)("ul",{className:"list-disc list-inside ml-2",children:[(0,n.jsx)("li",{children:"r = 基礎擴散半徑"}),(0,n.jsx)("li",{children:"d_w = 風速影響距離"})]})]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium mb-2",children:"座標轉換說明"}),(0,n.jsxs)("div",{className:"pl-4",children:[(0,n.jsx)("p",{children:"將擴散距離轉換為地理座標："}),(0,n.jsx)("p",{className:"font-mono",children:"緯度 = 原點緯度 - (d_total \xd7 cos(θ)) / 111000"}),(0,n.jsx)("p",{className:"font-mono",children:"經度 = 原點經度 + (d_total \xd7 sin(θ)) / (111000 \xd7 cos(原點緯度))"}),(0,n.jsx)("p",{className:"text-xs mt-1",children:"註：111000 為地球緯度 1 度對應的距離（公尺）"})]})]})]})}),U&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,n.jsx)("h3",{className:"text-xs font-semibold mb-4",children:"plant"===k?"Reset Plant Location?":"user"===k?"Reset User Location?":"Reset All Settings?"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"plant"===k?"This will remove the nuclear power plant location. Are you sure?":"user"===k?"This will remove your current location. Are you sure?":"This will stop the current simulation and reset all settings. Are you sure?"}),(0,n.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,n.jsx)("button",{onClick:()=>T(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),(0,n.jsx)("button",{onClick:()=>{J(k),T(!1)},className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600",children:"Reset"})]})]})})]})}function p(){let{affectedCounties:e,plantLocation:s,userLocation:t,resetGame:l}=(0,r.g)();return(0,n.jsx)(a.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-2xl w-full",children:[(0,n.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Simulation Results"}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-xl font-semibold mb-3",children:"Affected Areas"}),(0,n.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:Array.from(e).map(e=>(0,n.jsx)("div",{className:"bg-red-100 text-red-800 px-3 py-1 rounded-full text-xs",children:e},e))})]}),t&&(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h3",{className:"text-xs font-semibold mb-2",children:"Your Location"}),(0,n.jsxs)("p",{className:"text-gray-700",children:["Latitude: ",t[0].toFixed(4),"\xb0N, Longitude: ",t[1].toFixed(4),"\xb0E"]})]}),(0,n.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,n.jsx)("h3",{className:"text-xl font-semibold mb-3 text-yellow-800",children:"Key Takeaways"}),(0,n.jsxs)("ul",{className:"list-disc list-inside space-y-2 text-yellow-700",children:[(0,n.jsx)("li",{children:"When a nuclear disaster strikes, time is life. Taiwan's dense population and limited area make our response time exceptionally precious."}),(0,n.jsx)("li",{children:"When considering nuclear safety, we must look beyond efficiency and assess whether we have adequate capabilities to handle the worst-case scenario."}),(0,n.jsx)("li",{children:"Emergency preparedness and evacuation planning are crucial for densely populated areas."})]})]}),(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)("button",{onClick:()=>{l()},className:"btn btn-primary text-xs px-8 py-3",children:"Try Another Scenario"})})]})]})})}let g=[{id:"chinshan",name:"Chinshan Nuclear Power Plant (No. 1)",location:[25.286,121.595],description:"Located in Shihmen District, New Taipei City. First nuclear power plant in Taiwan."},{id:"kuosheng",name:"Kuosheng Nuclear Power Plant (No. 2)",location:[25.211,121.66],description:"Located in Wanli District, New Taipei City. Second nuclear power plant in Taiwan."},{id:"maanshan",name:"Maanshan Nuclear Power Plant (No. 3)",location:[21.954,120.744],description:"Located in Hengchun Township, Pingtung County. Third nuclear power plant in Taiwan."},{id:"lungmen",name:"Lungmen Nuclear Power Plant (No. 4)",location:[25.022,121.92],description:"Located in Gongliao District, New Taipei City. Fourth nuclear power plant in Taiwan (never operational)."}];function j(){let{setPlantLocation:e,setUserLocation:s}=(0,r.g)(),[t,l]=(0,i.useState)(""),[a,c]=(0,i.useState)(null),d=s=>{let t=g.find(e=>e.id===s);t&&(l(s),e(t.location))};return(0,n.jsxs)("div",{className:"bg-white/90 backdrop-blur-sm rounded-lg p-6 shadow-lg max-w-2xl mx-auto",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Game Setup"}),(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h3",{className:"text-xs font-semibold mb-4 text-gray-700",children:"Select Nuclear Power Plant"}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.map(e=>(0,n.jsxs)("button",{onClick:()=>d(e.id),className:"p-4 rounded-lg border-2 transition-all ".concat(t===e.id?"border-red-500 bg-red-50":"border-gray-200 hover:border-red-300"),children:[(0,n.jsx)("h4",{className:"font-semibold text-gray-800",children:e.name}),(0,n.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:e.description})]},e.id))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-xs font-semibold mb-4 text-gray-700",children:"Your Location"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:"Click on the map to set your current location. This will help calculate the radiation spread and evacuation time to your position."}),a&&(0,n.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,n.jsxs)("p",{className:"text-xs text-gray-600",children:["Selected location: ",a[0].toFixed(4),"\xb0N, ",a[1].toFixed(4),"\xb0E"]})})]})]})}let f=(0,l.default)(()=>Promise.all([t.e(212),t.e(169)]).then(t.bind(t,9169)),{loadableGenerated:{webpack:()=>[9169]},ssr:!1,loading:()=>(0,n.jsx)("div",{className:"w-full h-[600px] bg-gray-100 rounded-lg flex items-center justify-center",children:(0,n.jsx)("p",{className:"text-gray-500",children:"Loading map..."})})});function N(){let{isSimulationRunning:e,timeRemaining:s}=(0,r.g)();return(0,n.jsx)("main",{className:"h-full-view flex flex-col bg-gray-50",children:(0,n.jsxs)("div",{className:"flex flex-row-md",children:[(0,n.jsxs)("div",{className:"container mx-auto px-4 py-8 flex-1 flex flex-col",children:[(0,n.jsx)("h1",{className:"text-4xl font-bold text-center mb-8",children:"Nuclear Escape: Crisis Simulator Game"}),(0,n.jsx)("p",{className:"text-xs font-bold text-center mb-8",children:"If a Nuclear Disaster Strikes… Where Can You Still Breathe?"}),!e&&300===s&&(0,n.jsx)("div",{className:"mb-8",children:(0,n.jsx)(j,{})}),(0,n.jsxs)("div",{className:"flex flex-row h-full",children:[(0,n.jsx)("div",{className:"flex-1 mb-4",children:(0,n.jsx)(f,{})}),0===s&&(0,n.jsx)(p,{})]})]}),(0,n.jsx)("div",{className:"overflow-y-auto h-full-view w-[300px]",children:(0,n.jsx)(u,{})})]})})}},985:function(e,s,t){"use strict";t.d(s,{ib:function(){return n}});let n={MAX_TIME:172800,UPDATE_INTERVAL:1e3,RADIATION_CLOUD_COLOR:"#ff0000",RADIATION_CLOUD_OPACITY:.2}},389:function(e,s,t){"use strict";t.d(s,{g:function(){return i}});var n=t(2020);let l={isSimulationRunning:!1,timeRemaining:t(985).ib.MAX_TIME,windDirection:0,windSpeed:5,simulationTime:60,affectedCounties:new Set,plantLocation:null,userLocation:null,isUserSafe:!0,isUserInDanger:!1,dangerLevel:"safe",lastUpdate:Date.now(),diffusionMode:"combined",spreadSpeed:0},i=(0,n.Ue)(e=>({...l,startSimulation:()=>e(e=>({...e,isSimulationRunning:!0,lastUpdate:Date.now()})),pauseSimulation:()=>e(e=>({...e,isSimulationRunning:!1})),resetGame:()=>{e(e=>({...e,isSimulationRunning:!1,plantLocation:null,userLocation:null,simulationTime:60,isUserSafe:!0,isUserInDanger:!1,dangerLevel:"safe",lastUpdate:Date.now(),diffusionMode:"combined",spreadSpeed:0}))},setPlantLocation:s=>e(e=>({...e,plantLocation:s})),setUserLocation:s=>e(e=>({...e,userLocation:s})),setWindDirection:s=>e(e=>({...e,windDirection:s})),setWindSpeed:s=>e(e=>({...e,windSpeed:s})),setSpreadSpeed:s=>e(e=>({...e,spreadSpeed:s})),updateSimulation:()=>e(e=>{if(!e.isSimulationRunning)return e;let s=Date.now(),t=(s-e.lastUpdate)/1e3;return{...e,simulationTime:e.simulationTime+t/60,lastUpdate:s}}),updateWindDirection:s=>e({windDirection:s}),updateSpreadSpeed:s=>e({spreadSpeed:s}),addAffectedCounty:s=>e(e=>({...e,affectedCounties:new Set([...Array.from(e.affectedCounties),s])})),updateTimeRemaining:s=>e(e=>({...e,timeRemaining:s})),decrementTime:()=>e(e=>({...e,timeRemaining:Math.max(0,e.timeRemaining-1)})),setSimulationTime:s=>e(e=>({...e,simulationTime:s})),setDiffusionMode:s=>e(e=>({...e,diffusionMode:s}))}))}},function(e){e.O(0,[254,971,69,744],function(){return e(e.s=8468)}),_N_E=e.O()}]);